SEP 020 -- The Implementation class for biological clones and replicates
========================================================================


SEP                   | <leave empty>
----------------------|--------------
**Title**             | SEP 020 -- The Implementation class for biological clones and replicates
**Authors**           | Raik Gruenberg (raik.gruenberg@gmail.com)
**Editor**            | Nicholas Roehner (nicholasroehner@gmail.com)
**Type**              | Data Model
**SBOL Version**      | 2.3
**Replaces**          | SEP 014, SEP 016, SEP 017, SEP 018, SEP 019
**Status**            | Draft
**Created**           | 01-Dec-2017
**Last modified**     | 01-Nov-2017

Abstract
-----------

Experimental information recorded for one engineered clone of cells or a batch of biomaterial is often not representative for the behavior of another clone or batch. The reason are additional variables (known or unknown) such as mutations or stochastic biochemical events that lie outside the scope of the actual design. Bioengineers are therefore used to tracking the identity of clones, batches or replicates of biological materials whenever experimental results are collected. The **Implementation** class (as defined in SEP 19) is here modified in order to allow a reliable and straightforward identification of cell lines, bacterial clones and other replicates of biomaterial without any requirement of prov-O (provenance ontology) vocabulary. This moreover allows for a more direct and unambiguous connection from Experimental data, via clone/batch identification to the sequence of a design.


Table of Contents
---------------------


Rationale <a name="rationale"></a>
----------------

* Identify cell lines (clones, replicates, batches) while providing a direct link to the intented design
* Provide a clear representation for biomaterials as they are routinely exchanged between labs or obtained from commercial vendors and collections such as AddGene, ACTC and others
* Provide an unambiguous and minimal representation for clone / cell line identity as currently required by Journals for experimental papers
* Allow to attach experimental results to clones/batches

This proposal is mostly identical and complementary to SEP 19 but differs in the following aspects:
* Allow tools to parse and generate `Implementation` records without having to deal with detailed workflow information or the prov-O ontology
* Workflow & provenance information form an *additional layer* of meta information rather than being required
* Ensure that the link from Experimental data through clone/batch to (intended) design is as direct and unambiguous as possible and does not require iterations over chains of events / activities (with the associated risk of missing links)


Specification <a name="specification"></a>
----------------------------------------------

We propose a new class `Implementation`. 

### 2.1 Implementation class <a name="implementation"></a>

An `Implementation` represents a real, physical instance of a synthetic biological construct which may be associated with, typically more than one, actual laboratory samples. Note that the representation of individual samples (as in LIMS systems) remains outside the scope of SBOL. Whether or not two samples are considered to belong to the same batch or at which point they are split into separate `Implementation` instances is decided by the user and will be a matter of community best practices in a given area of bioengineering. 

`Implementation` MUST be linked back to its *intended* design, either a `ModuleDefinition` or `ComponentDefinition` using a mandatory field `design` (this is the main difference to SEP 19). An `Implementation` MAY also link, via an optional field `build`, to an additional `ModuleDefinition` or `ComponentDefinition` which represents a more current or a more detailed picture of its actual structure as it was realized in the laboratory. 

![Implementation class UML diagram](images/sep_020_implementation.png "Implementation class UML diagram")
**Figure 1:** Diagram of the `Implementation` class and its associated properties

#### 2.1.1 Implementation.design <a name="design"></a>

Each `Implementation` record MUST have exactly one `design` property which MUST point to a `ComponentDefinition`. This `ComponentDefinition` is interpreted as the *intended* design. Sister clones of a bioengineering experiment will therefore always point to the same `design` `ComponentDefinition` regardless of whether or not they accurately implement this design.

If, after creation of a clone, additional design information becomes available that equally applies to all clones of an experiment, then the design `ComponentDefinition` instance may be updated in-place. Alternatively the `design` field of all affected `Implementations` may be changed to point to a new version of the `ComponentDefinition`. In both cases, previous versions and reasons for the change can, optionally, be tracked using established prov-O versioning (e.g. `ComponentDefinition.wasDerivedFrom`) as already prescribed by SBOL.


#### 2.1.2 Implementation.build <a name="build"></a>

An optional `Implementation.build` property references one `ComponentDefinition` that describes the, possibly deviating, actual physical composition of a realized construct. `build` MUST NOT reference the same `ComponentDefinition` that `design` points to. Instead, if no extra or deviating structural information exists for a given clone, the `build` field is simply not to be used at all. [This is a difference to SEP 19]

Preferably, the `build` structure should indeed be specific for this particular `Implementation`. For example, it may be based on the sequencing of this particular clone. `Implementation.build` SHOULD NOT be used to introduce general corrections to the original design (see 2.1.1 above).


#### 2.1.3 Implementation Identity <a name="identity"></a>

Once created, the `uri` identifier of an `Implementation` instance MUST NOT change. The `Implementation` record is mutable and may change over time as new information is added or corrected. However, since `Implementation` represents a physical object in the real world, changes to the information *about* this physical object MUST NOT lead to a change of its unique identifier.


### 2.2 Best Practices <a name="best_practices"></a>

#### 2.2.1 Link to Experimental Data <a name="experimental"></a>

`Implementation` links to experimental data using the `attachment` field approved in SEP 18. It is RECOMMENDED that `sbol:Attachment` instances containing experimental data are further annotated by prov-O activity records as shown in the following Figure.

![Experimental Data](images/sep_020_impl_to_exp.png "Association of Experimental Data with Clones/Batches and intended Design")
**Figure 2.2:** Association of experimental data with `Implementation` (Clones/Batches) and Design.

Such `Attachments` MAY instead also be grouped into `Collections`. Detailed will have to be determined by practical use.


#### 2.2.2 Link to assembly method <a name="assembly"></a>

Detailed information about how a given construct or organism was built in the lab can be encoded in a `prov-O:Activity` record. [Arguably, this should be described in a separate SEP. The detailed description of experiments and protocols is beyond the scope of this SEP]. All sister clones of a construction experiment SHOULD point to the same `Activity` record. Clones that implement the same design but were produced independently (e.g. in a different lab) SHOULD NOT point to the same `Activity` record, even if the assembly protocol happened to be identical.

![Assembly Method](images/sep_020_assembly.png "Representation of construct or organism assembly")
**Figure 2.3:** Representation of Assembly method and provenance.

Note: The Assembly `Activity` MAY also have a `Usage:design` record pointing to the design `ComponentDefinition`. This link is redundant with the `Implementation.design` field and therefore optional [A difference to SEP 19].


#### 2.2.3 Link to ancestral clones or batches <a name="ancestry"></a>

`prov:wasDerivedFrom` references are used to express that one batch or clone was directly created from another one. It is RECOMMENDED that this should always be accompanied by a `prov:Activity` activity record that outlines how one batch was derived from the other. Examples are: transformation of DNA into bacteria to generate a new cell stock or purification of DNA or proteins from a given cell stock. Also the simple splitting of cell lines or inoculation of a new culture from a given bacterial stock may or may not warrant the definition of a new `Implementation` record. 

![Ancestry](images/sep_020_ancestry.png "Document cell line or clone ancestry")
**Figure 2.3:** Documentation of cell line or clone ancestry.



#### 2.4.1 Integration with Prov-O and workflow information <a name="usage_provo"></a>

In contrast to SEP 19, the use of prov-O vocabulary together with `Implementation` is encouraged but optional. Parsing of prov-O information MUST NOT be needed for (1) the simple identification of a clone, (2) neither for determining what structure (a.k.a. sequence) it is supposed to have. 

It is NOT RECOMMENDED to create `wasDerivedFrom` links from `Implementation` to its `design` `ComponentDefinition` as the two classes represent different types of things (an actual clone in the lab versus an intended sequence).

  * the pedigree of an actual clone or batch, i.e. how was derived from another clone or batch by experimentation in the lab -- use `wasGeneratedBy` + `Activity` records. Additional `Usage` roles may need to be defined for bioengineering needs. Example activities in this sense are the simple splitting of cell lines, the generation of a bacterial clone by transformation with DNA or of DNA from a bacterial clone. 


#### 2.2.2 Versioning versus Provenance Semantics <a name="provenance_semantics"></a>

In line with SEP 19 (see detailed discussion in 2.3.2), we RECOMMEND as a best practice that objects linked by Activities not be successive versions of each other, though we leave this at the discretion of users and library developers.

### 2.3 Validation Rules <a name="validation_rules"></a>

Not much is needed beyond the strict data model definition:

* `Implementation.build` SHOULD NOT point to the same `ComponentDefinition` as `Implementation.design` (Warning)

* If a "Build" `Activity` referenced by `Implementation.wasGeneratedBy` contains a `Usage:design` record, then this `Usage:design` MUST point to the same `ComponentDefinition` or `ModuleDefinition` as `Implementation.design`. (Error)

SEP 19 prescribes a host of additional validation rules related to prov-O usage. 


Examples <a name='examples'></a>
-------------------------------

### 3.1 Clone and cell line identification

![Clone identification](images/sep_019_implementation_example.png "Clone identification")

**Example 4:** An Implementation links a design ComponentDefinition to its build. In the left example, the build does not match its design specification. In the right hand example, the build does match its specification.

### 3.2 Design-Build-Test workflow

![Representing workflows with PROV-O](images/sep_019_provo.png "PROV-O")

**Example 2:** A workflow for model-based design represented using PROV-O classes and annotations

**Improvements over SEP 19**:


### 3.3 Assembly Provenance <a name="example3"></a>

![Assembly provenance](images/sep_019_assembly_provenance.png "Assembly Provenance")

**Example 3:** A detailed representation of assembly provenance. Assembly provenance allows a synthetic biologist to track all the physical components or samples which go into a DNA assembly protocol. The difference to SEP 19 is that the link to the design is direct rather than being part of the `Activity`.


### 3.4 Linking experimental information to Design


### 3.5 Pedigree of bacterial clones in iGEM Interlab Study <a name="example5"></a>

![Attachment example](images/sep_019_attachment_example.png "Attachment example")

**Example 5:** `Attachments` wrap an experimental data file and include important meta-data that helps tools interpret the data. This example attaches quality control data in the form of a gel image and sequencing results.


Backwards Compatibility <a name='compatibility'></a>
-----------------

This proposal does not affect backwards compatibility.

Discussion <a name='discussion'></a>
-----------------

[Example 2](#example2) I remain sceptical as to why `Implementation` should require any providence link to its design. In my view, a given `Implementation` either implements a design or it does not. It may nevertheless be useful to have DNA assembly activities also reference the design. However, I would argue that there should not be any "wasDerivedFrom" link between Implementation and design just as we do not introduce multiple "wasDerivedFrom" links to all the fragment components used during the assembly.


Relation to Other SEPs <a name='competing_seps'></a>
-----------------

This proposal evolved from SEP 16 after discussion on the Github issue tracker, and on the ["Design-Build-Test" thread]: https://groups.google.com/forum/#!topic/sbol-dev/AnpwJP2_f5A

SEP 020 can either replace or complement SEP 19.  

References <a name='references'></a>
----------------

Copyright <a name='copyright'></a>
-------------
<p xmlns:dct="http://purl.org/dc/terms/" xmlns:vcard="http://www.w3.org/2001/vcard-rdf/3.0#">
  <a rel="license"
     href="http://creativecommons.org/publicdomain/zero/1.0/">
    <img src="http://i.creativecommons.org/p/zero/1.0/88x31.png" style="border-style: none;" alt="CC0" />
  </a>
  <br />
  To the extent possible under law,
  <a rel="dct:publisher"
     href="sbolstandard.org">
    <span property="dct:title">SBOL developers</span></a>
  has waived all copyright and related or neighboring rights to
  <span property="dct:title">SEP 020</span>.
This work is published from:
<span property="vcard:Country" datatype="dct:ISO3166"
      content="US" about="sbolstandard.org">
  United States</span>.
</p>
